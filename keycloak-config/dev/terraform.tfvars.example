keycloak_url            = "https://keycloak.dev.example.com"
# Optional: override bootstrap-derived auth realm/client.
# keycloak_auth_realm      = "terraform"
# keycloak_client_id       = "terraform"
# keycloak_client_secret   = "replace-me"
keycloak_container_name = "keycloak-dev"

bootstrap_state_bucket     = "keycloak-terraform-state"
bootstrap_state_key        = "bootstrap/terraform.tfstate"
bootstrap_state_region     = "us-east-1"
bootstrap_state_endpoint   = "https://minio.example.com"
bootstrap_state_access_key = "minio"
bootstrap_state_secret_key = "minio123"
approval_portal_url = "https://approval.dev.example.com"

shared_scopes = {
  common-claims = {
    description = "Shared claims scope"
    mappers = [
      {
        name            = "dept-transform-shared"
        protocol_mapper = "value-transform-protocol-mapper"
        config = {
          "source.user.attribute"     = "dept_code"
          "target.claim.name"         = "dept"
          "mapping.file"              = "mappings/dept_code.json"
          "mapping.cache.enabled"     = "true"
          "mapping.cache.ttl.seconds" = "300"
        }
      }
    ]
  }
}

clients = {
  app = {
    client_id     = "app"
    name          = "Sample App"
    auto_approve  = true
    root_url      = "https://app.dev.example.com"
    redirect_uris = ["https://app.dev.example.com/*"]
    web_origins   = ["https://app.dev.example.com"]
    login_theme   = "AAP"
    # Optional client settings (defaults defined in variables.tf)
    access_type                 = "PUBLIC"
    standard_flow_enabled       = true
    direct_access_grants_enabled = false
    pkce_code_challenge_method  = "S256"

    scopes = {
      terms = {
        description = "Terms & Conditions"
        tc_sets = {
          privacy = {
            required = true
            version  = "2026-01-16"
            url      = "https://example.com/privacy"
            template = "terms-privacy.ftl"
            key      = "privacy"
          }
        }
      }

      claims = {
        description = "Claims scope"
      }

      # (확장 예시) terms 말고 다른 scope에도 동일 구조로 적용 가능
      marketing = {
        description = "Marketing consent scope"
        tc_sets = {
          ads = {
            required = false
            version  = "2026-01-10"
          }
        }
      }
    }

    default_scopes = ["terms", "claims", "common-claims"]

    mappers = [
      {
        name            = "dept-transform"
        scope           = "claims"
        protocol_mapper = "value-transform-protocol-mapper"
        config = {
          "source.user.attribute"       = "dept_code"
          "target.claim.name"           = "dept"
          "mapping.inline"              = ""
          "mapping.file"                = "mappings/dept_code.json"
          "mapping.db.enabled"          = "false"
          "mapping.db.jdbc.url"         = "jdbc:postgresql://db:5432/app"
          "mapping.db.username"         = "mapping_user"
          "mapping.db.password"         = "change-me"
          "mapping.db.query"            = "select code, name from dept_mapping"
          "mapping.api.enabled"         = "false"
          "mapping.api.url"             = "https://mapping.example.com/dept"
          "mapping.api.auth.type"       = "bearer"
          "mapping.api.auth.token"      = "change-me"
          "mapping.api.auth.user"       = ""
          "mapping.api.auth.password"   = ""
          "mapping.api.timeout.ms"      = "3000"
          "mapping.cache.enabled"       = "true"
          "mapping.cache.ttl.seconds"   = "300"
          "mapping.client.autoKey"      = "true"
          "mapping.client.key"          = "dept.map"
          "fallback.original"           = "true"
          "source.user.attribute.multi" = "false"
          "access.token.claim"          = "true"
          "id.token.claim"              = "true"
          "userinfo.token.claim"        = "true"
          "claim.name"                  = "dept"
          "jsonType.label"              = "String"
        }
      }
    ]
  }

  app_secondary = {
    client_id     = "app-secondary"
    name          = "Sample App Secondary"
    auto_approve  = false
    root_url      = "https://app2.dev.example.com"
    redirect_uris = ["https://app2.dev.example.com/*"]
    web_origins   = ["https://app2.dev.example.com"]
    login_theme   = "AAP"

    scopes = {
      terms = {
        description = "Terms & Conditions"
        tc_sets = {
          privacy = {
            required = true
            version  = "2026-01-16"
          }
        }
      }
    }

    default_scopes = ["terms"]
    mappers        = []
  }
}

saml_idp_alias           = "corp-saml"
saml_idp_display_name    = "Corp SAML"
saml_entity_id           = "https://sso.dev.example.com/metadata"
saml_idp_entity_id       = "https://sso.dev.example.com/idp"
saml_sso_url             = "https://sso.dev.example.com/saml/sso"
saml_slo_url             = "https://sso.dev.example.com/saml/slo"
saml_signing_certificate = "-----BEGIN CERTIFICATE-----\nMIID...snip...\n-----END CERTIFICATE-----"
saml_enabled             = true
saml_principal_type      = "ATTRIBUTE"
saml_principal_attribute = "email"
saml_idp_mappers = [
  {
    name           = "email-attribute"
    type           = "attribute_importer"
    attribute_name = "email"
    user_attribute = "email"
  },
  {
    name            = "dept-hardcoded"
    type            = "hardcoded_attribute"
    attribute_name  = "dept"
    attribute_value = "finance"
  },
  {
    name           = "role-mapper"
    type           = "attribute_to_role"
    attribute_name = "department"
    claim_name     = "department"
    claim_value    = "finance"
    role           = "finance-user"
    extra_config = {
      syncMode = "INHERIT"
    }
  },
  {
    name                    = "custom-mapper"
    type                    = "custom"
    identity_provider_mapper = "saml-user-attribute-idp-mapper"
    extra_config = {
      syncMode      = "INHERIT"
      Claim         = "preferred_username"
      UserAttribute = "preferred_username"
    }
  },
  {
    name           = "hardcoded-attribute"
    type           = "hardcoded_attribute"
    attribute_name = "session_attr"
    attribute_value = "value"
    user_session   = true
  },
  {
    name  = "hardcoded-group"
    type  = "hardcoded_group"
    group = "/DevOps"
  },
  {
    name  = "hardcoded-role"
    type  = "hardcoded_role"
    role  = "my-realm-role"
  }
]
